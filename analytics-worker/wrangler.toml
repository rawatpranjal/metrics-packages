name = "tech-econ-analytics"
main = "index.js"
compatibility_date = "2024-01-01"
workers_dev = true

# Environment variables
[vars]
# Get your Zone ID from Cloudflare Dashboard > Overview (right sidebar)
CF_ZONE_ID = "005264aee472c876aa0ddbfe46ae8601"
# Account ID for Web Analytics API
CF_ACCOUNT_ID = "e53411f5363195f142c4b30558be082a"

# Secrets (set via: wrangler secret put <NAME>)
# CF_API_TOKEN - Zone analytics (optional)
# CF_ACCOUNT_TOKEN - Account analytics for Web Analytics (required for /web-stats)
#   Permissions: Account > Account Analytics > Read
# ADMIN_KEY - Random secret for /migrate endpoint protection
#   Generate: openssl rand -hex 32

# KV Namespace for storing analytics events
# Run: wrangler kv:namespace create ANALYTICS_EVENTS
# Then update the id below with your namespace ID
[[kv_namespaces]]
binding = "ANALYTICS_EVENTS"
id = "55666fb0baa64b12a16c9bc307483781"

# D1 Database for analytics storage
# Run: wrangler d1 create tech-econ-analytics-db
# Then update the database_id below
[[d1_databases]]
binding = "DB"
database_name = "tech-econ-analytics-db"
database_id = "7c92226a-53ba-4d34-97ba-09bb985321a3"

# To deploy:
# 1. Install wrangler: npm install -g wrangler
# 2. Login: wrangler login
# 3. Create D1 database: wrangler d1 create tech-econ-analytics-db
# 4. Update database_id above with the ID from step 3
# 5. Run schema: wrangler d1 execute tech-econ-analytics-db --file=./schema.sql
# 6. Deploy: wrangler deploy
# 7. Update hugo.toml trackerEndpoint with your worker URL
