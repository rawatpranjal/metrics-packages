{{ define "main" }}
<!-- Hero Section -->
<header class="hero hero-bundles">
    <h1 class="hero-title">Learning Paths</h1>
    <p class="hero-tagline">Curated bundles to master specific topics. Each path includes resources, packages, and papers with explanations of why they're included.</p>
</header>

<div class="container">
    <!-- Filter Row -->
    <div class="bundles-filter-row">
        <div class="filter-group">
            <label>Difficulty:</label>
            <div class="filter-chips" id="difficulty-filters">
                <button class="filter-chip active" data-difficulty="all">All</button>
                <button class="filter-chip" data-difficulty="Easy">Easy</button>
                <button class="filter-chip" data-difficulty="Medium">Medium</button>
                <button class="filter-chip" data-difficulty="Hard">Hard</button>
            </div>
        </div>
        <div class="filter-group">
            <label>Category:</label>
            <select id="category-filter" class="category-select">
                <option value="all">All Categories</option>
                {{ $categories := slice }}
                {{ range .Site.Data.bundles }}
                    {{ if not (in $categories .category) }}
                        {{ $categories = $categories | append .category }}
                    {{ end }}
                {{ end }}
                {{ range $cat := sort $categories }}
                <option value="{{ $cat }}">{{ $cat }}</option>
                {{ end }}
            </select>
        </div>
    </div>

    <!-- Bundles Grid -->
    <div class="bundles-grid" id="bundles-grid">
        {{ range .Site.Data.bundles }}
        <div class="bundle-card" data-difficulty="{{ .difficulty }}" data-category="{{ .category }}">
            <div class="bundle-card-header">
                <div class="bundle-icon">
                    {{ if eq .icon "rocket" }}
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/>
                        <path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/>
                        <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/>
                        <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/>
                    </svg>
                    {{ else if eq .icon "flask" }}
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 3h6"/>
                        <path d="M10 3v6.3a1 1 0 0 1-.2.6L4 17.3a2 2 0 0 0 1.5 3.3h13a2 2 0 0 0 1.5-3.3l-5.8-7.4a1 1 0 0 1-.2-.6V3"/>
                    </svg>
                    {{ else if eq .icon "chart-line" }}
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 3v18h18"/>
                        <path d="m19 9-5 5-4-4-3 3"/>
                    </svg>
                    {{ else if eq .icon "bullhorn" }}
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m3 11 18-5v12L3 13v-2z"/>
                        <path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"/>
                    </svg>
                    {{ else if eq .icon "project-diagram" }}
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="6" height="6" rx="1"/>
                        <rect x="15" y="3" width="6" height="6" rx="1"/>
                        <rect x="9" y="15" width="6" height="6" rx="1"/>
                        <path d="M6 9v3a1 1 0 0 0 1 1h4"/>
                        <path d="M18 9v3a1 1 0 0 1-1 1h-4"/>
                        <path d="M12 13v2"/>
                    </svg>
                    {{ else }}
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
                    </svg>
                    {{ end }}
                </div>
                <div class="bundle-badges">
                    <span class="bundle-badge bundle-badge-{{ lower .difficulty }}">{{ .difficulty }}</span>
                    <span class="bundle-badge bundle-badge-time">{{ .time_estimate }}</span>
                </div>
            </div>
            <h3 class="bundle-title">{{ .name }}</h3>
            <p class="bundle-description">{{ .description }}</p>
            <div class="bundle-meta">
                <span class="bundle-category">{{ .category }}</span>
                <span class="bundle-item-count">{{ len .items }} items</span>
            </div>
            <a href="/bundles/{{ .id }}/" class="bundle-link">
                View Path
                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m9 18 6-6-6-6"/>
                </svg>
            </a>
        </div>
        {{ end }}
    </div>

    <!-- Empty State -->
    <div id="bundles-empty" class="bundles-empty" style="display: none;">
        <p>No learning paths match your filters.</p>
        <button onclick="resetFilters()" class="btn-secondary">Reset Filters</button>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var difficultyBtns = document.querySelectorAll('#difficulty-filters .filter-chip');
    var categorySelect = document.getElementById('category-filter');
    var grid = document.getElementById('bundles-grid');
    var empty = document.getElementById('bundles-empty');
    var cards = document.querySelectorAll('.bundle-card');

    function filterBundles() {
        var activeDiff = document.querySelector('#difficulty-filters .filter-chip.active').dataset.difficulty;
        var activeCat = categorySelect.value;
        var visibleCount = 0;

        cards.forEach(function(card) {
            var matchDiff = activeDiff === 'all' || card.dataset.difficulty === activeDiff;
            var matchCat = activeCat === 'all' || card.dataset.category === activeCat;

            if (matchDiff && matchCat) {
                card.style.display = '';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        empty.style.display = visibleCount === 0 ? 'block' : 'none';
    }

    difficultyBtns.forEach(function(btn) {
        btn.addEventListener('click', function() {
            difficultyBtns.forEach(function(b) { b.classList.remove('active'); });
            btn.classList.add('active');
            filterBundles();
        });
    });

    categorySelect.addEventListener('change', filterBundles);

    window.resetFilters = function() {
        difficultyBtns.forEach(function(b) { b.classList.remove('active'); });
        difficultyBtns[0].classList.add('active');
        categorySelect.value = 'all';
        filterBundles();
    };
});
</script>
{{ end }}
